# Конвертер различных типов файлов

Данный компонент отвечает за преобразование входящих файлов во внутренний формат приложения.

### Описание конвертера
Конвертер представляет собой изолированное приложение, которое слушает 8002 порт. На вход оно ожидает различные форматы файлов, но без указания типа.

Файлы должны быть отправлены в массиве `files[]` с указанием `Content-type: multipart/form-data`.

Каждый чанк в теле запроса должен содержать заголовок `Content-disposition: application/octet-stream`.

Конвертер сам определяет тип входящих файлов, использую магические байты/сигнатуру для различных типов файлов, и преобразует данные из входящего файла во внутреннее представление приложения, описанное в разделах ниже.

### Как пользоваться этим
Для того, чтобы поднять сервер конвертера, нужно **пока что** воспользоваться командой `go run .`. Для проверки конвертера стоит положить парочку файлов из трейнинг сета в папку `samples` и воспользоваться следующими командами:

Команда для отправки файлов и просмотра заголовков:
```
curl -i -F "files[]=@./samples/A1957.mat" "http://localhost:8002"
```

Команда для отправки и сохранения результата в файл: `outfile`:
```
curl -F "files[]=@./samples/A1957.mat" "http://localhost:8002" > outfile
```

Кроме того, для трансформирования файла напрямую можно воспользоваться коротким питоновским скриптом вот так:
```
python3 matlab.py < samples/A1957.mat > outfile
```

### Описание тренировочных данных
 Приложение сильно зависит от предобученной модели, поэтому важную роль играет то, какие есть данные.
 
На вход моделям из соревнования http://2018.icbeb.org/Challenge.html подаются файлы из заранее подготовленного трейнинг сета, данные ЭКГ для каждого человека представлены в виде отдельного файла в формате *MATLAB 5*. Этот матлабовский файл содержит в себе следующие данные:

1. Пол, представлен в виде строк Male/Female;
2. Возраст;
3. 12 отведений, каждое снято в течение 10 секунд с частотой 500Гц.

### Требования к внутреннему формату данных
Для общения между модулями системы удобно использовать какой-то единый формат данных, причем он должен быть компактным и удобным в использовании. Кроме того, его должно быть удобно использовать с любым языком программирования, без сложностей с установкой дополнительных библиотек.

### Описание внутреннего формата данных
1. Пол кодируется одним байтом, где 1 это мужчина, а 0 это женщина.
2. Возраст кодируется одним байтом.
3. Сигналы 12 отведений по 5000 чисел с плавающей точкой кодируются в плоский поток байт, где каждая точка представлена 8 байтами.

В итоге внутренний формат данных представляет собой сконкатенированную последовательность байт, где сначала идет байт пола, байт возраста, после чего 480 000 байт сигналов.

В итоговом виде одна ЭКГ представлена в приложении с помощью 480 002 байт в бинарном виде.

### Порядок записи отведений
Так как отведения в матлабовском формате не подписаны, логично сделать это тут, чтобы ничего не перепутать. Итак, названия всех отведений по порядку:
1. I
2. II
3. III
4. aVR
5. aVL
6. aVF
7. V1
8. V2
9. V3
10. V4
11. V5
12. V6
